<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - Inventory Management System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-12 text-center mb-4">
                <h1 class="display-5 text-info">üì¶ Products Management</h1>
                <a href="/" class="btn btn-outline-secondary">‚Üê Back to Home</a>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-header bg-info text-white">
                        <h4>Add New Product</h4>
                    </div>
                    <div class="card-body">
                        <form id="addProductForm">
                            <div class="mb-3">
                                <label for="productName" class="form-label">Product Name</label>
                                <input type="text" class="form-control" id="productName" required>
                            </div>
                            <div class="mb-3">
                                <label for="productPrice" class="form-label">Price</label>
                                <input type="number" step="0.01" class="form-control" id="productPrice" required>
                            </div>
                            <button type="submit" class="btn btn-info">Add Product</button>
                        </form>
                        <div id="addProductResult" class="mt-3"></div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-header bg-warning text-white">
                        <h4>Update Product</h4>
                    </div>
                    <div class="card-body">
                        <form id="updateProductForm">
                            <div class="mb-3">
                                <label for="updateProductId" class="form-label">Product ID</label>
                                <input type="number" class="form-control" id="updateProductId" required>
                            </div>
                            <div class="mb-3">
                                <label for="updateProductName" class="form-label">Product Name</label>
                                <input type="text" class="form-control" id="updateProductName" required>
                            </div>
                            <div class="mb-3">
                                <label for="updateProductPrice" class="form-label">Price</label>
                                <input type="number" step="0.01" class="form-control" id="updateProductPrice" required>
                            </div>
                            <button type="submit" class="btn btn-warning">Update Product</button>
                        </form>
                        <div id="updateProductResult" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-12">
                <div class="card shadow">
                    <div class="card-header bg-success text-white">
                        <h4>Products List</h4>
                    </div>
                    <div class="card-body">
                        <button id="getProductsBtn" class="btn btn-success mb-3">Get All Products</button>
                        <div id="productsResult"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-header bg-danger text-white">
                        <h4>Delete Product</h4>
                    </div>
                    <div class="card-body">
                        <form id="deleteProductForm">
                            <div class="mb-3">
                                <label for="deleteProductId" class="form-label">Product ID</label>
                                <input type="number" class="form-control" id="deleteProductId" required>
                            </div>
                            <button type="submit" class="btn btn-danger">Delete Product</button>
                        </form>
                        <div id="deleteProductResult" class="mt-3"></div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h4>Get Product by ID</h4>
                    </div>
                    <div class="card-body">
                        <form id="getProductForm">
                            <div class="mb-3">
                                <label for="getProductId" class="form-label">Product ID</label>
                                <input type="number" class="form-control" id="getProductId" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Get Product</button>
                        </form>
                        <div id="getProductResult" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Add product
        document.getElementById('addProductForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('productName').value;
            const price = parseFloat(document.getElementById('productPrice').value);
            
            try {
                const response = await fetch('/api/products', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name, price })
                });
                
                const result = await response.json();
                const resultDiv = document.getElementById('addProductResult');
                
                if (response.ok) {
                    resultDiv.innerHTML = `<div class="alert alert-success">‚úÖ Product added successfully!<br>ID: ${result.id}<br>Name: ${result.name}<br>Price: $${result.price}</div>`;
                    document.getElementById('addProductForm').reset();
                } else {
                    resultDiv.innerHTML = `<div class="alert alert-danger">‚ùå Failed to add product</div>`;
                }
            } catch (error) {
                document.getElementById('addProductResult').innerHTML = `<div class="alert alert-danger">‚ùå Error: ${error.message}</div>`;
            }
        });
        
        // Update product
        document.getElementById('updateProductForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('updateProductId').value;
            const name = document.getElementById('updateProductName').value;
            const price = parseFloat(document.getElementById('updateProductPrice').value);
            
            try {
                const response = await fetch(`/api/products/${id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name, price })
                });
                
                const result = await response.json();
                const resultDiv = document.getElementById('updateProductResult');
                
                if (response.ok) {
                    resultDiv.innerHTML = `<div class="alert alert-success">‚úÖ Product updated successfully!<br>ID: ${result.id}<br>Name: ${result.name}<br>Price: $${result.price}</div>`;
                } else {
                    resultDiv.innerHTML = `<div class="alert alert-danger">‚ùå Failed to update product</div>`;
                }
            } catch (error) {
                document.getElementById('updateProductResult').innerHTML = `<div class="alert alert-danger">‚ùå Error: ${error.message}</div>`;
            }
        });
        
        // Get all products
        document.getElementById('getProductsBtn').addEventListener('click', async () => {
            try {
                const response = await fetch('/api/products');
                const products = await response.json();
                const resultDiv = document.getElementById('productsResult');
                
                if (response.ok) {
                    let html = '<div class="table-responsive"><table class="table table-striped"><thead><tr><th>ID</th><th>Name</th><th>Price</th></tr></thead><tbody>';
                    products.forEach(product => {
                        html += `<tr><td>${product.id}</td><td>${product.name}</td><td>$${product.price}</td></tr>`;
                    });
                    html += '</tbody></table></div>';
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = `<div class="alert alert-danger">‚ùå Failed to get products</div>`;
                }
            } catch (error) {
                document.getElementById('productsResult').innerHTML = `<div class="alert alert-danger">‚ùå Error: ${error.message}</div>`;
            }
        });
        
        // Delete product
        document.getElementById('deleteProductForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('deleteProductId').value;
            
            try {
                const response = await fetch(`/api/products/${id}`, {
                    method: 'DELETE'
                });
                
                const resultDiv = document.getElementById('deleteProductResult');
                
                if (response.ok) {
                    resultDiv.innerHTML = `<div class="alert alert-success">‚úÖ Product deleted successfully!</div>`;
                    document.getElementById('deleteProductForm').reset();
                } else {
                    resultDiv.innerHTML = `<div class="alert alert-danger">‚ùå Failed to delete product</div>`;
                }
            } catch (error) {
                document.getElementById('deleteProductResult').innerHTML = `<div class="alert alert-danger">‚ùå Error: ${error.message}</div>`;
            }
        });
        
        // Get product by ID
        document.getElementById('getProductForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('getProductId').value;
            
            try {
                const response = await fetch(`/api/products/${id}`);
                const product = await response.json();
                const resultDiv = document.getElementById('getProductResult');
                
                if (response.ok) {
                    resultDiv.innerHTML = `<div class="alert alert-info">üì¶ Product Details:<br>ID: ${product.id}<br>Name: ${product.name}<br>Price: $${product.price}</div>`;
                } else {
                    resultDiv.innerHTML = `<div class="alert alert-danger">‚ùå Product not found</div>`;
                }
            } catch (error) {
                document.getElementById('getProductResult').innerHTML = `<div class="alert alert-danger">‚ùå Error: ${error.message}</div>`;
            }
        });
    </script>
</body>
</html>